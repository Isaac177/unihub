{% load static %}
{% block styles %}
{% endblock %}

<nav class="navbar">
  <div class="navbar__logo">
    <a href="{% url 'home' %}" class="navbar__link">uniHub</a>
  </div>
     <ul class="navbar__list">
        {% for m in menu %}
          <li class="navbar__item">
            <a href="{% url m.url_name %}" class="navbar__link">{{ m.title }}</a>
          </li>
        {% endfor %}
      </ul>
  <div class="navbar__toggle">
    <span class="navbar__icon"></span>
  </div>
    {% if user.is_authenticated %}
      <div class="navbar__user">
        <div class="navbar__user--name">
{#          <a href="{% url 'user-profile' %}" class="navbar__link">{{ user.username }}</a>#}
        </div>
        <div class="navbar__user--logout">
            <form action="{% url 'logout' %}" method="post" id="logout-form">
                {% csrf_token %}
                <a href="#" id="logout-link" class="navbar__link">Logout</a>
            </form>
        </div>
      </div>
    {% else %}
      <div class="navbar__user">
        <div class="navbar__user--name">
          <a href="{% url 'login' %}" class="navbar__link">Login</a>
        </div>
        <div class="navbar__user--logout">
          <a href="{% url 'register' %}" class="navbar__link">Register</a>
        </div>
      </div>
    {% endif %}
</nav>

{% block scripts %}
    <script src="{% static 'js/user-dash.js' %}"></script>
{% endblock %}

<script>
document.getElementById('logout-link').addEventListener('click', function(event) {
  event.preventDefault();
    console.log('clicked')

  const csrfToken = document.getElementsByName('csrfmiddlewaretoken')[0].value;
  const form = document.createElement('form');
  form.setAttribute('method', 'post');
  form.setAttribute('action', '{% url 'logout' %}');

  const csrfInput = document.createElement('input');
  csrfInput.setAttribute('type', 'hidden');
  csrfInput.setAttribute('name', 'csrfmiddlewaretoken');
  csrfInput.setAttribute('value', csrfToken);
  form.appendChild(csrfInput);

  document.body.appendChild(form);
  form.submit();
});
</script>

